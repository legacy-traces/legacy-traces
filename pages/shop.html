<!DOCTYPE html>
<html lang="en" ng-app="tamilTeesApp" data-theme="dark">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>SHOP | LEGACY TRACES</title>
    <!-- Google Fonts -->
    <link href="https://fonts.googleapis.com/css2?family=Anton&family=Inter:wght@400;600;700&display=swap"
        rel="stylesheet">
    <!-- Bootstrap CSS -->
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
    <!-- Custom CSS -->
    <link rel="stylesheet" href="../assets/css/styles.css">
    <!-- AngularJS -->
    <script src="https://ajax.googleapis.com/ajax/libs/angularjs/1.8.2/angular.min.js"></script>
</head>

<body class="" ng-controller="ShopController">
    <!-- Navbar -->
    <nav class="navbar navbar-expand-lg navbar-light fixed-top py-3 shadow-sm">
        <div class="container">
            <a class="navbar-brand font-anton fs-3 text-uppercase" href="../index.html">LEGACY TRACES</a>
            <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarNav">
                <span class="navbar-toggler-icon"></span>
            </button>
            <div class="collapse navbar-collapse" id="navbarNav">
                <ul class="navbar-nav ms-auto gap-3 align-items-center">
                    <li class="nav-item"><a class="nav-link" href="../index.html">Home</a></li>
                    <li class="nav-item"><a class="nav-link active" href="shop.html">Shop</a></li>
                    <li class="nav-item"><a class="nav-link" href="customize.html">Customize</a></li>
                    <li class="nav-item"><a class="nav-link" href="about.html">Our Story</a></li>
                    <li class="nav-item"><a class="nav-link" href="contact.html">Contact</a></li>
                    <li class="nav-item position-relative">
                        <a href="#" class="nav-link" id="favorites-toggle">
                            FAVORITES
                            <span class="favorite-badge" ng-show="favorites.length > 0">{{favorites.length}}</span>
                        </a>
                    </li>
                </ul>
                <div class="ms-lg-4 mt-3 mt-lg-0">
                    <a href="#" class="btn btn-outline-light btn-sm rounded-0">CART (0)</a>
                </div>
            </div>
        </div>
    </nav>

    <!-- Favorites Panel -->
    <div class="favorites-panel" id="favorites-panel">
        <div class="favorites-header">
            <h4 class="font-anton text-uppercase mb-0">Your Favorites</h4>
            <button class="btn-close btn-close-white" id="favorites-close"></button>
        </div>
        <div class="favorites-list">
            <div class="favorite-item" ng-repeat="item in favorites">
                <img ng-src="{{getImageUrl(item['Primary Image'])}}" alt="{{item.Name}}">
                <div class="favorite-item-info">
                    <h6 class="font-anton text-uppercase mb-1">{{item.Name}}</h6>
                    <p class="small text-secondary mb-0">₹{{item.Price}}</p>
                </div>
                <button class="favorite-item-remove" ng-click="toggleFavorite(item)">
                    &times;
                </button>
            </div>
            <div class="text-center py-5" ng-if="favorites.length === 0">
                <p class="text-secondary">No favorites yet.</p>
            </div>
        </div>
        <div class="favorites-footer mt-auto pt-3 border-top border-secondary" ng-if="favorites.length > 0">
            <button class="btn btn-accent w-100 rounded-0 fw-bold" ng-click="checkoutFavorites()">CHECKOUT ALL</button>
        </div>
    </div>

    <!-- Main Content -->
    <div class="container" style="margin-top: 100px;">
        <div class="row">
            <!-- Filters -->
            <div class="col-lg-3 mb-4">
                <div class="sticky-top" style="top: 100px;">
                    <div class="d-flex justify-content-between align-items-center mb-3">
                        <h4 class="font-anton mb-0">FILTERS</h4>
                        <button class="btn btn-sm btn-outline-danger rounded-0" ng-click="clearFilters()">CLEAR</button>
                        <button class="btn btn-link text-white text-decoration-none d-lg-none" type="button"
                            data-bs-toggle="collapse" data-bs-target="#filterCollapse">
                            +
                        </button>
                    </div>
                    <div class="collapse d-lg-block" id="filterCollapse">
                        <div class="mb-4">
                            <h6 class="text-uppercase fw-bold text-secondary mb-2">Category</h6>
                            <div class="form-check" ng-repeat="cat in categories">
                                <input class="form-check-input filter-check" type="radio" name="categoryFilter"
                                    id="cat{{cat.ID}}" ng-model="$parent.selectedCategory" ng-value="cat.ID"
                                    ng-change="applyFilters()">
                                <label class="form-check-label" for="cat{{cat.ID}}">{{cat.Name}}</label>
                            </div>
                        </div>
                        <div class="mb-4">
                            <h6 class="text-uppercase fw-bold text-secondary mb-2">Collection</h6>
                            <div class="form-check" ng-repeat="col in collections">
                                <input class="form-check-input bg-dark border-secondary filter-check" type="radio"
                                    name="collectionFilter" id="col{{col.ID}}" ng-model="$parent.selectedCollection"
                                    ng-value="col.ID" ng-change="applyFilters()">
                                <label class="form-check-label" for="col{{col.ID}}">{{col.Name}}</label>
                            </div>
                        </div>
                        <div class="mb-4">
                            <h6 class="text-uppercase fw-bold text-secondary mb-2">Size</h6>
                            <div class="d-flex gap-2 flex-wrap">
                                <button class="btn btn-sm btn-outline-secondary rounded-0">S</button>
                                <button class="btn btn-sm btn-outline-secondary rounded-0">M</button>
                                <button class="btn btn-sm btn-outline-secondary rounded-0">L</button>
                                <button class="btn btn-sm btn-outline-secondary rounded-0">XL</button>
                                <button class="btn btn-sm btn-outline-secondary rounded-0">XXL</button>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
            <!-- Product Grid -->
            <div class="col-lg-9">
                <div class="d-flex justify-content-between align-items-center mb-4">
                    <p class="mb-0 text-secondary" id="productCount">Showing {{filteredProducts.length}} Products</p>
                    <select class="form-select border-secondary w-auto rounded-0" ng-model="priceSort"
                        ng-change="applyFilters()">
                        <option value="">Sort By: Default</option>
                        <option value="lowToHigh">Price: Low to High</option>
                        <option value="highToLow">Price: High to Low</option>
                    </select>
                </div>
                <div class="row row-cols-1 row-cols-md-3 g-4" id="productGrid">
                    <!-- Loop Products -->
                    <div class="col product-item" ng-repeat="product in filteredProducts">
                        <div class="product-card" ng-click="viewProduct(product)" style="cursor: pointer;">
                            <button class="favorite-btn" ng-class="{'active': isFavorite(product)}"
                                ng-click="toggleFavorite(product); $event.stopPropagation();">
                                <svg width="20" height="20" fill="currentColor" viewBox="0 0 20 20">
                                    <path
                                        d="M3.172 5.172a4 4 0 015.656 0L10 6.343l1.172-1.171a4 4 0 115.656 5.656L10 17.657l-6.828-6.829a4 4 0 010-5.656z">
                                    </path>
                                </svg>
                            </button>
                            <div class="position-relative mb-3">
                                <img ng-src="{{getImageUrl(product['Primary Image'])}}" class="img-fluid w-100"
                                    alt="{{product.Name}}" style="height: 350px; object-fit: cover;">
                            </div>
                            <h5 class="font-anton mb-1 text-uppercase">{{product.Name}}</h5>
                            <p class="text-secondary small mb-2">{{product['Short description']}}</p>
                            <p class="fw-bold mb-0">₹{{product.Price}}</p>
                        </div>
                    </div>
                </div>
                <!-- Pagination -->
                <nav class="mt-5" ng-if="filteredProducts.length > 0">
                    <ul class="pagination justify-content-center">
                        <li class="page-item disabled"><a class="page-link text-secondary border-secondary rounded-0"
                                href="#">Pre</a>
                        </li>
                        <li class="page-item active"><a class="page-link bg-danger border-danger text-white rounded-0"
                                href="#">1</a></li>
                        <li class="page-item"><a class="page-link text-dark border-secondary rounded-0" href="#">2</a>
                        </li>
                        <li class="page-item"><a class="page-link text-dark border-secondary rounded-0" href="#">3</a>
                        </li>
                        <li class="page-item"><a class="page-link text-dark border-secondary rounded-0"
                                href="#">Next</a></li>
                    </ul>
                </nav>
                <div class="text-center py-5" ng-if="filteredProducts.length === 0">
                    <h5 class="text-secondary">No products found matching your criteria.</h5>
                    <button class="btn btn-outline-danger mt-3 rounded-0" ng-click="clearFilters()">CLEAR ALL
                        FILTERS</button>
                </div>
            </div>
        </div>
    </div>
    <!-- Footer -->
    <footer class="text-secondary py-5 border-top border-light mt-5">
        <div class="container">
            <p class="text-center small mb-0">&copy; 2026 LEGACY TRACES. All rights reserved.</p>
        </div>
    </footer>

    <!-- Bootstrap JS -->
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
    <script src="../assets/js/shopController.js"></script>

    <!-- Favorites UI Toggle Script -->
    <script>
        const favoritesToggle = document.getElementById('favorites-toggle');
        const favoritesPanel = document.getElementById('favorites-panel');
        const favoritesClose = document.getElementById('favorites-close');

        favoritesToggle.addEventListener('click', (e) => {
            e.preventDefault();
            favoritesPanel.classList.add('active');
        });

        favoritesClose.addEventListener('click', () => {
            favoritesPanel.classList.remove('active');
        });

        document.addEventListener('click', (e) => {
            if (!favoritesPanel.contains(e.target) && !e.target.closest('#favorites-toggle')) {
                favoritesPanel.classList.remove('active');
            }
        });
    </script>
</body>

</html>